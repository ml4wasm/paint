<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
  <input id="place" placeholder="Type text to encode here."> <button onclick="changeText()" id="placer"> encode </button>
  <canvas id="myCanvas" width="400" height="400">
<!-- <script src="pkg/grok.js"></script> -->

<script>
var worker = new Worker('worker.js');
var worker2 = new Worker('wasm.js');
Array.prototype.extend = function (other_array) {
    other_array.forEach(function(v) {this.push(v)}, this);
}
var encoder = new TextEncoder;

function changeText(){
a1 = document.getElementById("place").value;
b1 = encoder.encode(a1);
var weights = Object.values(b1);
while (weights.length < 640000) {
weights.extend(weights)
}
weights.length = 640000;

worker.onmessage = function (message) {
  console.log(typeof message.data)
  console.log(typeof weights)

  worker2.postMessage([message.data,weights]);
  console.log("here")

  var c = document.getElementById("myCanvas");
  console.log("here too")
  var ctx = c.getContext("2d");
  console.log("whee")
  worker2.onmessage = function(e){
    ctx.drawImage(e.data,0,0,400,400);
    console.log("oh wow")
  }


  }








}





</script>
  </body>
</html>
