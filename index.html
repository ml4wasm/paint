<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>ml4wasm paintings</title>

    <style>
    :root {
		--black: black;
		--blue: blue;
		--transform: scale(1.02) translate(0px, 2px) skew(1deg, 0deg);
		--base-size: 25px;
		--zero: 0;
		--two: 2px;
		--trans: transparent;
		--twenty-one: 21px;
		--ten: 10px;
		--three: 3px;
		--one: 1px;
		--twenty-three: 23px
	}

body {
  padding: 0px;
  margin: 0px;
  overflow: hidden;
  font-family: times, cursive;
  font-size: 20px;
  line-height: 140%;
  background-image: url('https://64.media.tumblr.com/eff200e0891ccf24db774994cd820e3c/59fdb9db8a44b6ed-c5/s2048x3072/543986c918b80db88f5c2222249c6163eedee85a.jpg');

  background-size: 100% 150%;
  background-position: center;


}
textarea {
margin-top: var(--zero);
margin-bottom: var(--ten);
height: 130px;
font-family: Arial;
font-size: var(--base-size);
border-radius: var(--ten);
padding-left: 1px;
padding-right: var(--zero);
width: 400px;
margin-bottom: var(--ten);
transition: .5s
}
button{
  font-size: 20px;
  padding: 5px;
  border-radius: 5px;
  background:rgba(255,255,255, 0.9);

}
textarea:hover{
box-shadow: 0 0 5px white;
border-radius: var(--three)
}
#wrapper {
display: grid;
grid-template-columns: 1fr 1fr;
grid-template-rows: 1fr 1fr 1fr 1fr;
width: 420px;
height: 720px;
box-sizing: border-box;
}
#icon{
width: 95%;
height: 95%;
grid-column: 1/2;
grid-row: 4/5;
}
#icon a img {
width: 100%;
height: 100%;
background: #ffffff;
background-image: url('https://64.media.tumblr.com/eff200e0891ccf24db774994cd820e3c/59fdb9db8a44b6ed-c5/s2048x3072/543986c918b80db88f5c2222249c6163eedee85a.jpg');
background-position: center;
margin: auto;
background-size: cover;
border: 4px ridge #737373;
filter: drop-shadow(0 0 2px #000000);
border-radius: 10px;
transition: 0.3s;
-o-transition: all 0.3s ease-out;
-webkit-transition: all 0.3s ease-out;
-moz-transition: all 0.3s ease-out;
}

#sidebar{
height: 99%;
box-sizing: border-box;
z-index:1;
padding:10px;
background:rgba(255,255,255, 0.1);
overflow-wrap: break-word;
overflow: auto;
overflow:hidden;
overflow:hidden;
border: 4px ridge #737373;
filter:drop-shadow(0 0 2px #000000);
border-radius: 10px;
grid-column: 2/3;
grid-row: 4/5;
}

#sidetext {
    font-family: times, cursive;
    font-size: 40px;
    background:rgba(255,255,255, 0.4);
    background-position: center;
    background-size: cover;
    border: 4px ridge #737373;
    filter: drop-shadow(0 0 2px #000000);
    border-radius: 10px;
}
#description{
box-sizing:border-box;
z-index:396584906;
line-height:120%;
font-size:20px;
text-align:center;
height:calc(100% - 46px);
height:calc(100% - 45px - 40px - 0.5rem);
overflow:auto;
padding:5px;
height:100%;
overflow:auto;
height:calc(100% - 46px);
height:calc(100% - 45px - 40px - 0.5rem);
background:#ffffff;
background-position:center;
border: 1px double #000000;
border-radius: 5px;
transition:0.3s;
-o-transition: all 0.3s ease-out;
-webkit-transition: all 0.3s ease-out;
-moz-transition: all 0.3s ease-out;
}
#content {
  grid-column-start:1;
  grid-column-end:3;
padding: 10px;
margin: auto;
text-align: center;
box-sizing: border-box;
width: 100%;
height: 100%;
overflow-x: hidden;
overflow-y: auto;

background:rgba(255,255,255, 0.4);
border: 4px ridge #737373;
filter: drop-shadow(0 0 2px #000000);
border-radius: 10px;
grid-row-start: 1;
grid-row-end: 4;
}

#white{
  color: white;
  font-size: 30px;
}



    </style>
  </head>
  <body>
<center><div id="wrapper">

  <div id="content">

  <textarea id="place" placeholder="Type text here.This text will be passed to the perceptron as an array of weights for forward propagation."></textarea><br><button onclick="changeText()" id="placer"> generate image </button>
  <br><br>
  <canvas id="myCanvas" width="300" height="300">
  </div>



<div id="sidebar">
<div id='description'><div>The user input is translated into an array of weights for forward propagation in a <a href="https://en.wikipedia.org/wiki/Perceptron">perceptron</a>. <br> The perceptron produces an array of numbers that JavaScript glue then translates into an image. This website is built with WebAssembly. </div></div>
<div><br>
<center><a id="white" href="https://github.com/ml4wasm/paint">github repo</a></center>
</div>

</div>


<div id="icon">

    <a href="/paint"><img src="https://raw.githubusercontent.com/ml4wasm/paint/main/assets/sidebar.jpg"></a>
</div>


</wrapper></center>
<script>
var worker = new Worker('worker.js');
var wasm = new Worker('wasm.js');
var text = new Worker('text.js');
var c = document.getElementById("myCanvas");
var ctx = c.getContext("2d");
var mImgData = ctx.createImageData(300, 300);


function changeText(){
a1 = document.getElementById("place").value;
text.postMessage(a1);


wasm.onmessage = function(z){
console.log("wasm got a message. just checking âœ§")

  var send = z.data;
  console.log("we got sent "+ send );

  send.length= 360000;

  var srcIndex=0, dstIndex=0, curPixelNum=0;

  	for (curPixelNum=0; curPixelNum<300*300;  curPixelNum++){
  		mImgData.data[dstIndex] = send[srcIndex];		// r
  		mImgData.data[dstIndex+1] = send[srcIndex+1];	// g
  		mImgData.data[dstIndex+2] = send[srcIndex+2];	// b
  		mImgData.data[dstIndex+3] = 255; // 255 = 0xFF - constant alpha, 100% opaque
  		srcIndex += 3;
  		dstIndex += 4;
  	}
    mImgData.data = send;
    console.log(mImgData);
    ctx.putImageData(mImgData, 0, 0);
  }




}

</script>
  </body>
</html>
