<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
  <input id="place" placeholder="Type text to encode here."> <button onclick="changeText()" id="placer"> encode </button>
  <canvas id="myCanvas" width="400" height="400">
<script src="pkg/grok.js"></script>

<script>
Array.prototype.extend = function (other_array) {
    /* You should include a test to check whether other_array really is an array */
    other_array.forEach(function(v) {this.push(v)}, this);
}
var encoder = new TextEncoder;
var worker = new Worker('worker.js');


function changeText(){
  a1 = document.getElementById("place").value;
b1 = encoder.encode(a1);
var weights = Object.values(b1);
  while (weights.length < 640000) {

    weights.extend(weights)

  }
    console.log(weights);
    weights.length = 640000;
    console.log(weights);



const { predict } = wasm_bindgen;


self.onmessage = function (message) {

  console.log("weights are " + weights);

  console.log("received "+ message.data);

  async function run() {
  await wasm_bindgen('pkg/grok_bg.wasm');

  // const display = predict(e.data, weights)

  var c = document.getElementById("myCanvas");
  var ctx = c.getContext("2d");
  // ctx.drawImage(display,0,0,400,400);
  }

}

run();

}



</script>
  </body>
</html>
